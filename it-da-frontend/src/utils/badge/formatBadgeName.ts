// src/utils/badge/formatBadgeName.ts

/**
 * 배지명 앞에 붙는 "R10", "T01" 같은 코드(prefix)를 제거해서
 * 화면에는 "리뷰 10회", "첫 로그인" 처럼 사람친화적으로 보이게 합니다.
 *
 * 지원 예:
 * - "R10 리뷰 10회" -> "리뷰 10회"
 * - "T01 첫 로그인" -> "첫 로그인"
 * - "R10_리뷰 10회" -> "리뷰 10회"
 * - "T01-첫 로그인" -> "첫 로그인"
 * - "R10: 리뷰 10회" -> "리뷰 10회"
 */
export function formatBadgeName(name: string | null | undefined): string {
    const raw = String(name ?? "").trim();
    if (!raw) return "";

    // 공백 정리(연속 공백/탭/개행 -> 단일 공백)
    let s = raw.replace(/\s+/g, " ").trim();

    // 1) 맨 앞의 코드(prefix) 제거
    // - 대문자 1~3글자 + 숫자 1~3자리 (예: R10, T01, AI2, P100 등)
    // - 뒤에 구분자(공백, -, _, :, |, ., ), ], })가 올 수 있음
    // - 구분자 여러 개도 허용
    s = s.replace(/^[A-Z]{1,3}\d{1,3}(?:[\s\-_:\|.,)\]}\u00B7]+)+/g, "");

    // 2) 혹시 남아있는 "R10 " 같은 패턴이 연속으로 붙어있을 경우 반복 제거
    // (예: "R10 T01 첫 로그인" 같은 이상 데이터 방어)
    while (/^[A-Z]{1,3}\d{1,3}(?:[\s\-_:\|.,)\]}\u00B7]+)+/.test(s)) {
        s = s.replace(/^[A-Z]{1,3}\d{1,3}(?:[\s\-_:\|.,)\]}\u00B7]+)+/g, "");
    }

    // 3) 마지막으로 다시 공백 정리
    s = s.replace(/\s+/g, " ").trim();

    // 만약 전부 제거돼서 빈 문자열이면 원문을 최소한으로 반환(디버깅에도 도움)
    return s || raw;
}
